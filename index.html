<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TRUVANI | Global AI News Network</title>
  <meta name="description" content="Real-time, AI-powered, blockchain-verified global news.">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#e63946">

  <!-- Preload Critical -->
  <link rel="preconnect" href="https://www.gstatic.com">
  <link rel="preload" href="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js" as="script">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <style>
    :root{--p:#e63946;--a:#00d4ff;--d:#0a0a0a;--l:#fff;--c:#f5f5f5;--b:#eee}
    body.dark-mode{--l:#1a1a1a;--c:#222;--b:#333}
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:system-ui,sans-serif;background:var(--c);color:#333;line-height:1.6}
    .container{max-width:1200px;margin:auto;padding:0 16px}
    header{background:var(--l);box-shadow:0 2px 8px rgba(0,0,0,.1);position:sticky;top:0;z-index:100}
    .header-main{display:flex;justify-content:space-between;align-items:center;padding:16px 0}
    .logo{font-size:32px;font-weight:900;background:linear-gradient(45deg,var(--p),#c91828);-webkit-background-clip:text;color:transparent}
    .search-box input{border:none;outline:none;padding:8px 12px;width:180px;background:var(--c);border:1px solid var(--b);border-radius:25px}
    .mode-toggle{cursor:pointer;font-size:18px;padding:8px}
    .hero-news img{width:100%;height:380px;object-fit:cover}
    .news-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px}
    .news-card{background:var(--l);border-radius:12px;overflow:hidden;box-shadow:0 4px 15px rgba(0,0,0,.05)}
    .news-card img{width:100%;height:180px;object-fit:cover}
    .skeleton{animation:pulse 1.5s infinite}
    @keyframes pulse{0%,100%{background:#e0e0e0}50%{background:#f0f0f0}}
  </style>
</head>
<body>
  <header>
    <div class="container header-main">
      <div><div class="logo">TRUVANI</div></div>
      <div style="display:flex;gap:12px;align-items:center">
        <div class="search-box"><input type="text" placeholder="Search..." id="search"></div>
        <i class="fa-solid fa-moon mode-toggle" id="modeToggle"></i>
        <a href="quantum.html" style="background:var(--a);color:#000;padding:8px 16px;border-radius:25px;font-weight:600">AI</a>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="hero-news" id="hero">Loading...</div>
    <div class="news-grid" id="grid">
      <div class="news-card skeleton" style="height:300px">&nbsp;</div>
      <div class="news-card skeleton" style="height:300px">&nbsp;</div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js";
    import { getFirestore, collection, query, orderBy, limit, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js";

    const app = initializeApp({
      apiKey: "AIzaSyAeGWwKLkHB43i1FbedgkANPKcTCBh0Z9A",
      authDomain: "truvani-news-5ac15.firebaseapp.com",
      projectId: "truvani-news-5ac15",
      storageBucket: "truvani-news-5ac15.firebasestorage.app",
      messagingSenderId: "742142167141",
      appId: "1:742142167141:web:c2c116f5e50a574de85e8c"
    });

    const db = getFirestore(app);
    const $ = s => document.querySelector(s);

    onSnapshot(query(collection(db, 'articles'), orderBy('timestamp', 'desc'), limit(6)), snap => {
      if (snap.empty) { $('#hero').innerHTML = '<h2>No news yet</h2>'; return; }
      const articles = snap.docs.map(d => d.data());
      $('#hero').innerHTML = `<img src="${articles[0].imageUrl}" loading="eager"><h1>${articles[0].title}</h1>`;
      $('#grid').innerHTML = articles.slice(1).map(a => `
        <div class="news-card">
          <img src="${a.imageUrl}" loading="lazy">
          <div style="padding:16px"><h3>${a.title}</h3></div>
        </div>
      `).join('');
    });

    $('#modeToggle').addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      $('#modeToggle').classList.toggle('fa-moon'); $('#modeToggle').classList.toggle('fa-sun');
    });

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js');
    }
  </script>
</body>
</html>
