<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Article | TRUVANI</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <style>
    body{font-family:system-ui;margin:0;background:#f5f5f5;padding:20px}
    .article{max-width:800px;margin:auto;background:#fff;padding:30px;border-radius:16px;box-shadow:0 4px 20px rgba(0,0,0,.1)}
    img{width:100%;height:400px;object-fit:cover;border-radius:12px;margin-bottom:20px}
    h1{font-size:32px;margin:20px 0}
    .meta{color:#666;margin:15px 0}
  </style>
</head>
<body>
  <div class="article" id="article">Loading...</div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAeGWwKLkHB43i1FbedgkANPKcTCBh0Z9A",
      authDomain: "truvani-news-5ac15.firebaseapp.com",
      projectId: "truvani-news-5ac15",
      storageBucket: "truvani-news-5ac15.appspot.com",
      messagingSenderId: "742142167141",
      appId: "1:742142167141:web:c2c116f5e50a574de85e8c"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const urlParams = new URLSearchParams(window.location.search);
    const id = urlParams.get('id');

    if (!id) {
      document.getElementById('article').innerHTML = '<h1>Article not found</h1>';
      return;
    }

    const docRef = doc(db, 'news', id);  // Changed to 'news' collection
    getDoc(docRef).then((snap) => {  // Fixed syntax
      if (!snap.exists()) {
        document.getElementById('article').innerHTML = '<h1>Article not found</h1>';
        return;
      }
      const a = snap.data();
      document.getElementById('article').innerHTML = `
        <img src="${a.imageUrl || 'https://via.placeholder.com/800x400'}" alt="${a.title}">
        <h1>${a.title}</h1>
        <div class="meta">By ${a.author || 'TRUVANI'} â€¢ ${new Date(a.createdAt?.toDate()).toLocaleString()}</div>  <!-- Fixed field to createdAt -->
        <div style="font-size:18px;line-height:1.8">${a.content}</div>
      `;
    }).catch(err => {
      console.error('Error:', err);
      document.getElementById('article').innerHTML = '<h1>Error loading article</h1>';
    });
  </script>
</body>
</html>
